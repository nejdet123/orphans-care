<%- include('layout', {title: 'لوحة التحكم', active: 'dashboard'}) %>

<section class="dashboard-page">
    <div class="container">
        <h1 class="text-center my-4">لوحة التحكم</h1>
        <p class="text-center mb-5">تحليل وعرض نتائج استبيان تقييم الاحتياجات التدريبية</p>
        
        <div class="dashboard-container">
            <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="summary-tab" data-bs-toggle="tab" data-bs-target="#summary" type="button" role="tab" aria-controls="summary" aria-selected="true">ملخص النتائج</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="psychological-tab" data-bs-toggle="tab" data-bs-target="#psychological" type="button" role="tab" aria-controls="psychological" aria-selected="false">المجال النفسي والاجتماعي</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="educational-tab" data-bs-toggle="tab" data-bs-target="#educational" type="button" role="tab" aria-controls="educational" aria-selected="false">المجال التربوي والتعليمي</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="medical-tab" data-bs-toggle="tab" data-bs-target="#medical" type="button" role="tab" aria-controls="medical" aria-selected="false">المجال الصحي والطبي</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="religious-tab" data-bs-toggle="tab" data-bs-target="#religious" type="button" role="tab" aria-controls="religious" aria-selected="false">المجال الديني والروحي</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="recreational-tab" data-bs-toggle="tab" data-bs-target="#recreational" type="button" role="tab" aria-controls="recreational" aria-selected="false">المجال الترفيهي والرياضي</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="suggestions-tab" data-bs-toggle="tab" data-bs-target="#suggestions" type="button" role="tab" aria-controls="suggestions" aria-selected="false">الاقتراحات والملاحظات</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="organizations-tab" data-bs-toggle="tab" data-bs-target="#organizations" type="button" role="tab" aria-controls="organizations" aria-selected="false">تقارير المنظمات</button>
                </li>
            </ul>
            
            <div class="tab-content" id="dashboardTabsContent">
                <!-- ملخص النتائج -->
                <div class="tab-pane fade show active" id="summary" role="tabpanel" aria-labelledby="summary-tab">
                    <div class="dashboard-card">
                        <h3>ملخص نتائج الاستبيان</h3>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="participantsChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">توزيع المشاركين حسب المسمى الوظيفي</h4>
                            </div>
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="domainsChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">متوسط الاحتياج التدريبي حسب المجالات</h4>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="experienceChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">توزيع المشاركين حسب سنوات الخبرة</h4>
                            </div>
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="countriesChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">توزيع المشاركين حسب الدول</h4>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>إحصائيات عامة</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>البيان</th>
                                                <th>العدد/النسبة</th>
                                            </tr>
                                        </thead>
                                        <tbody id="statisticsTable">
                                            <tr>
                                                <td>إجمالي عدد المشاركين</td>
                                                <td id="totalParticipants">0</td>
                                            </tr>
                                            <tr>
                                                <td>عدد المنظمات المشاركة</td>
                                                <td id="totalOrganizations">0</td>
                                            </tr>
                                            <tr>
                                                <td>نسبة المشاركين الذين سبق لهم الحصول على تدريب</td>
                                                <td id="previousTrainingPercentage">0%</td>
                                            </tr>
                                            <tr>
                                                <td>المجال ذو الاحتياج التدريبي الأعلى</td>
                                                <td id="highestNeedDomain">-</td>
                                            </tr>
                                            <tr>
                                                <td>المجال ذو الاحتياج التدريبي الأدنى</td>
                                                <td id="lowestNeedDomain">-</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- المجال النفسي والاجتماعي -->
                <div class="tab-pane fade" id="psychological" role="tabpanel" aria-labelledby="psychological-tab">
                    <div class="dashboard-card">
                        <h3>المجال النفسي والاجتماعي</h3>
                        <div class="row">
                            <div class="col-md-8">
                                <div class="chart-container">
                                    <canvas id="psychologicalChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">متوسط الاحتياج التدريبي للمهارات النفسية والاجتماعية</h4>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-primary text-white">
                                        <h5 class="mb-0">أعلى المهارات احتياجاً</h5>
                                    </div>
                                    <div class="card-body">
                                        <ol id="topPsychologicalSkills">
                                            <li>مهارات التعامل مع الصدمات النفسية لدى الأيتام</li>
                                            <li>مهارات الإرشاد النفسي للأيتام</li>
                                            <li>استراتيجيات دمج الأيتام في المجتمع</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>تفاصيل الاحتياجات التدريبية حسب المسمى الوظيفي</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>المهارة/الموضوع</th>
                                                <th>مدير</th>
                                                <th>أخصائي نفسي</th>
                                                <th>أخصائي اجتماعي</th>
                                                <th>معلم</th>
                                                <th>مقدم رعاية</th>
                                                <th>المتوسط العام</th>
                                            </tr>
                                        </thead>
                                        <tbody id="psychologicalTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- المجال التربوي والتعليمي -->
                <div class="tab-pane fade" id="educational" role="tabpanel" aria-labelledby="educational-tab">
                    <div class="dashboard-card">
                        <h3>المجال التربوي والتعليمي</h3>
                        <div class="row">
                            <div class="col-md-8">
                                <div class="chart-container">
                                    <canvas id="educationalChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">متوسط الاحتياج التدريبي للمهارات التربوية والتعليمية</h4>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-success text-white">
                                        <h5 class="mb-0">أعلى المهارات احتياجاً</h5>
                                    </div>
                                    <div class="card-body">
                                        <ol id="topEducationalSkills">
                                            <li>استراتيجيات التعامل مع صعوبات التعلم</li>
                                            <li>مهارات اكتشاف وتنمية المواهب لدى الأيتام</li>
                                            <li>أساليب التحفيز وتعزيز الدافعية للتعلم</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>تفاصيل الاحتياجات التدريبية حسب المسمى الوظيفي</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>المهارة/الموضوع</th>
                                                <th>مدير</th>
                                                <th>أخصائي نفسي</th>
                                                <th>أخصائي اجتماعي</th>
                                                <th>معلم</th>
                                                <th>مقدم رعاية</th>
                                                <th>المتوسط العام</th>
                                            </tr>
                                        </thead>
                                        <tbody id="educationalTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- المجال الصحي والطبي -->
                <div class="tab-pane fade" id="medical" role="tabpanel" aria-labelledby="medical-tab">
                    <div class="dashboard-card">
                        <h3>المجال الصحي والطبي</h3>
                        <div class="row">
                            <div class="col-md-8">
                                <div class="chart-container">
                                    <canvas id="medicalChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">متوسط الاحتياج التدريبي للمهارات الصحية والطبية</h4>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-info text-white">
                                        <h5 class="mb-0">أعلى المهارات احتياجاً</h5>
                                    </div>
                                    <div class="card-body">
                                        <ol id="topMedicalSkills">
                                            <li>أساسيات الإسعافات الأولية</li>
                                            <li>مهارات التعامل مع الأمراض الشائعة</li>
                                            <li>مهارات الرعاية الصحية الأساسية للأيتام</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>تفاصيل الاحتياجات التدريبية حسب المسمى الوظيفي</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>المهارة/الموضوع</th>
                                                <th>مدير</th>
                                                <th>أخصائي نفسي</th>
                                                <th>أخصائي اجتماعي</th>
                                                <th>معلم</th>
                                                <th>مقدم رعاية</th>
                                                <th>المتوسط العام</th>
                                            </tr>
                                        </thead>
                                        <tbody id="medicalTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- المجال الديني والروحي -->
                <div class="tab-pane fade" id="religious" role="tabpanel" aria-labelledby="religious-tab">
                    <div class="dashboard-card">
                        <h3>المجال الديني والروحي</h3>
                        <div class="row">
                            <div class="col-md-8">
                                <div class="chart-container">
                                    <canvas id="religiousChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">متوسط الاحتياج التدريبي للمهارات الدينية والروحية</h4>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-warning text-dark">
                                        <h5 class="mb-0">أعلى المهارات احتياجاً</h5>
                                    </div>
                                    <div class="card-body">
                                        <ol id="topReligiousSkills">
                                            <li>أساليب غرس القيم الدينية لدى الأيتام</li>
                                            <li>مهارات تعليم العبادات بطريقة محببة</li>
                                            <li>مهارات ربط الأحكام الشرعية بالحياة اليومية</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>تفاصيل الاحتياجات التدريبية حسب المسمى الوظيفي</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>المهارة/الموضوع</th>
                                                <th>مدير</th>
                                                <th>أخصائي نفسي</th>
                                                <th>أخصائي اجتماعي</th>
                                                <th>معلم</th>
                                                <th>مقدم رعاية</th>
                                                <th>المتوسط العام</th>
                                            </tr>
                                        </thead>
                                        <tbody id="religiousTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- المجال الترفيهي والرياضي -->
                <div class="tab-pane fade" id="recreational" role="tabpanel" aria-labelledby="recreational-tab">
                    <div class="dashboard-card">
                        <h3>المجال الترفيهي والرياضي</h3>
                        <div class="row">
                            <div class="col-md-8">
                                <div class="chart-container">
                                    <canvas id="recreationalChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">متوسط الاحتياج التدريبي للمهارات الترفيهية والرياضية</h4>
                            </div>
                            <div class="col-md-4">
                                <div class="card">
                                    <div class="card-header bg-danger text-white">
                                        <h5 class="mb-0">أعلى المهارات احتياجاً</h5>
                                    </div>
                                    <div class="card-body">
                                        <ol id="topRecreationalSkills">
                                            <li>مهارات تصميم الأنشطة الترفيهية</li>
                                            <li>أساليب تنظيم الرحلات والمعسكرات</li>
                                            <li>مهارات تنظيم المسابقات والفعاليات</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>تفاصيل الاحتياجات التدريبية حسب المسمى الوظيفي</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>المهارة/الموضوع</th>
                                                <th>مدير</th>
                                                <th>أخصائي نفسي</th>
                                                <th>أخصائي اجتماعي</th>
                                                <th>معلم</th>
                                                <th>مقدم رعاية</th>
                                                <th>المتوسط العام</th>
                                            </tr>
                                        </thead>
                                        <tbody id="recreationalTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- الاقتراحات والملاحظات -->
                <div class="tab-pane fade" id="suggestions" role="tabpanel" aria-labelledby="suggestions-tab">
                    <div class="dashboard-card">
                        <h3>الاقتراحات والملاحظات</h3>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h4>المجالات التدريبية الأخرى المقترحة</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>#</th>
                                                <th>المجال المقترح</th>
                                                <th>التكرار</th>
                                            </tr>
                                        </thead>
                                        <tbody id="otherAreasTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <h4>اقتراحات تطوير البرامج التدريبية</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>#</th>
                                                <th>الاقتراح</th>
                                                <th>التكرار</th>
                                            </tr>
                                        </thead>
                                        <tbody id="suggestionsTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>تفاصيل الاقتراحات والملاحظات</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>المنظمة</th>
                                                <th>المسمى الوظيفي</th>
                                                <th>المجالات التدريبية المقترحة</th>
                                                <th>اقتراحات التطوير</th>
                                            </tr>
                                        </thead>
                                        <tbody id="detailedSuggestionsTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- تقارير المنظمات -->
                <div class="tab-pane fade" id="organizations" role="tabpanel" aria-labelledby="organizations-tab">
                    <div class="dashboard-card">
                        <h3>تقارير المنظمات</h3>
                        
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="organizationFilter" class="form-label">اختر المنظمة:</label>
                                    <select class="form-select" id="organizationFilter">
                                        <option value="all">جميع المنظمات</option>
                                        <!-- سيتم ملء هذه القائمة ديناميكياً -->
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="form-group">
                                    <label for="organizationCodeFilter" class="form-label">كود المنظمة:</label>
                                    <input type="text" class="form-control" id="organizationCodeFilter" placeholder="أدخل كود المنظمة">
                                </div>
                            </div>
                        </div>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="organizationDomainsChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">متوسط الاحتياج التدريبي حسب المجالات</h4>
                            </div>
                            <div class="col-md-6">
                                <div class="chart-container">
                                    <canvas id="organizationJobsChart"></canvas>
                                </div>
                                <h4 class="text-center mt-3">توزيع المشاركين حسب المسمى الوظيفي</h4>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>تفاصيل الاحتياجات التدريبية للمنظمة</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>المجال</th>
                                                <th>المهارة/الموضوع</th>
                                                <th>متوسط الاحتياج</th>
                                                <th>الترتيب</th>
                                            </tr>
                                        </thead>
                                        <tbody id="organizationDetailsTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <div class="row mt-5">
                            <div class="col-12">
                                <h4>المشاركون من المنظمة</h4>
                                <div class="table-responsive">
                                    <table class="table table-bordered">
                                        <thead class="table-dark">
                                            <tr>
                                                <th>الاسم</th>
                                                <th>المسمى الوظيفي</th>
                                                <th>سنوات الخبرة</th>
                                                <th>الفئة العمرية للأيتام</th>
                                                <th>نوع الرعاية المقدمة</th>
                                            </tr>
                                        </thead>
                                        <tbody id="organizationParticipantsTable">
                                            <!-- سيتم ملء هذا الجدول ديناميكياً -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="/js/dashboard.js"></script>

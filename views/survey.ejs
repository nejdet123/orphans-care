<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title><%= survey.surveyIntro.title %></title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css">
  <style>
    body { padding: 2rem; background-color: #f9f9f9; }
    .section-title { margin-top: 2rem; color: #0d6efd; }
    .question { margin-bottom: 1.5rem; }
  </style>
</head>
<body>

  <div class="container">
    <h1 class="mb-3 text-primary"><%= survey.surveyIntro.title %></h1>
    <p class="lead"><%= survey.surveyIntro.description %></p>

    <form action="/submit-survey" method="POST">

      <% survey.sections.forEach(section => { %>
        <div class="section">
          <h2 class="section-title"><%= section.title %></h2>

          <% section.subsections?.forEach(sub => { %>
            <div class="mb-4">
              <h5><%= sub.title %></h5>

              <% sub.questions?.forEach(q => { %>
                <div class="question">
                  <label class="form-label"><%= q.number %>. <%= q.text %> <% if (q.required) { %><span class="text-danger">*</span><% } %></label>

                  <% if (q.type === 'text') { %>
                    <input type="text" name="<%= q.id %>" class="form-control" placeholder="<%= q.placeholder || '' %>" <%= q.required ? 'required' : '' %> />
                  
                  <% } else if (q.type === 'radio') { %>
                    <% q.options?.forEach(opt => { %>
                      <div class="form-check">
                        <input class="form-check-input" type="radio" name="<%= q.id %>" value="<%= opt.value %>" <%= q.required ? 'required' : '' %> />
                        <label class="form-check-label"><%= opt.text %></label>
                      </div>
                    <% }) %>

                  <% } else if (q.type === 'checkbox') { %>
                    <% q.options?.forEach(opt => { %>
                      <div class="form-check">
                        <input class="form-check-input" type="checkbox" name="<%= q.id %>[]" value="<%= opt.value %>" />
                        <label class="form-check-label"><%= opt.text %></label>
                      </div>
                    <% }) %>

                  <% } else if (q.type === 'textarea') { %>
                    <textarea class="form-control" name="<%= q.id %>" rows="<%= q.rows || 3 %>" placeholder="<%= q.placeholder || '' %>"></textarea>
                  <% } %>

                </div>
              <% }) %>
            </div>
          <% }) %>
        </div>
      <% }) %>

      <button type="submit" class="btn btn-success">إرسال الاستبيان</button>
    </form>
  </div>

</body>
</html>
